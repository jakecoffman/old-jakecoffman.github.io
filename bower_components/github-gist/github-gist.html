<html><head><link rel="import" href="../polymer/polymer.html">
</head><body><dom-module id="github-gist">
  <template>
    <style id="styleEl"></style>
    <div id="gistEl"></div>
    <script id="scriptEl"></script>
  </template>
</dom-module>
<script>Polymer({is:"github-gist",properties:{gistid:{type:String,value:null,observer:"gistidChanged"},stylesheet:{type:String,value:null,observer:"stylesheetChanged"},defaultStylesheet:{type:String,value:null},callbackName:{type:String,value:null}},gistidChanged:function(){this.loadJSON()},fireEvent:function(t){this.fire(t.name,t.detail)},stylesheetChanged:function(){this.stylesheet=this.stylesheet||this.defaultStylesheet,this.applyStyle(this.stylesheet)},loadJSON:function(){var t="https://gist.github.com/"+this.gistid+".json";this.jsonp(t,this.processResponse.bind(this))},processResponse:function(t){t&&t.div&&t.stylesheet&&(0!==t.stylesheet.indexOf("http")&&(0!==t.stylesheet.indexOf("/")&&(t.stylesheet="/"+t.stylesheet),t.stylesheet="https://gist.github.com"+t.stylesheet),this.defaultStylesheet=t.stylesheet||null),this.stylesheet=this.stylesheet||this.defaultStylesheet,this.applyStyle(this.stylesheet),this.applyGist(t.div);var e={name:"github-gist-ready",detail:{gistId:this.gistid}};this.fireEvent(e)},applyGist:function(t){t&&(this.$.gistEl.innerHTML=t)},applyStyle:function(t){if(t){for(;this.$.styleEl.hasChildNodes();)this.$.styleEl.removeChild(this.$.styleEl.lastChild);this.$.styleEl.appendChild(document.createTextNode('@import url("'+t+'");'))}var e={name:"github-gist-stylesheet-changed",detail:{stylesheet:t}};this.fireEvent(e)},jsonp:function(t,e){var s=function(){var t="<p>Loading gist failed..</p>";this.applyGist(t)}.bind(this);if(this.callbackName="response_id_"+Math.random().toString(36).slice(2),window[this.callbackName]=function(t){delete window[this.callbackName],e(t)}.bind(this),t){Polymer.dom(this.root).removeChild(this.$$("#scriptEl"));var i=document.createElement("script");i.src=t+"?callback="+this.callbackName,i.id="scriptEl",Polymer.dom(this.root).appendChild(i),this.$$("#scriptEl").removeEventListener("error",s),this.$$("#scriptEl").addEventListener("error",s)}}});</script>
</body></html>